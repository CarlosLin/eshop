{"remainingRequest":"/Users/carlos/Desktop/E-shop/client/node_modules/babel-loader/lib/index.js!/Users/carlos/Desktop/E-shop/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/carlos/Desktop/E-shop/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/carlos/Desktop/E-shop/client/src/views/Items.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/carlos/Desktop/E-shop/client/src/views/Items.vue","mtime":1555294544660},{"path":"/Users/carlos/Desktop/E-shop/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/carlos/Desktop/E-shop/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/carlos/Desktop/E-shop/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/carlos/Desktop/E-shop/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _parseFloat from \"/Users/carlos/Desktop/E-shop/client/node_modules/@babel/runtime-corejs2/core-js/parse-float\";\nimport _parseInt from \"/Users/carlos/Desktop/E-shop/client/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/carlos/Desktop/E-shop/client/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapActions } from 'vuex';\nimport datepicker from 'vue-date-pick';\nimport 'vue-date-pick/dist/vueDatePick.css';\nimport PromotionsService from '../../services/PromotionsService.js';\nexport default {\n  name: 'items',\n  data: function data() {\n    return {\n      incart: [],\n      discount: [],\n      date: '2018-11-11',\n      coupon: '',\n      couponUse: false,\n      couponDiscount: 0\n    };\n  },\n  components: {\n    datepicker: datepicker\n  },\n  created: function created() {\n    this.getItemsApi();\n    this.getPromotionsApi(this.date);\n  },\n  computed: _objectSpread({}, mapGetters({\n    items: 'getItems',\n    promotions: 'getPromotions'\n  }), {\n    countQuantity: function countQuantity() {\n      var countQuantity = 0;\n      this.incart.forEach(function (ele) {\n        countQuantity += _parseInt(ele.quantity);\n      });\n      return countQuantity;\n    },\n    countTotal: function countTotal() {\n      var countTotal = 0.00;\n      var countCost = 0;\n      this.incart.forEach(function (ele) {\n        countTotal += _parseFloat(ele.quantity * ele.price);\n      });\n      this.discount.forEach(function (element) {\n        countCost += element.price;\n      });\n\n      if (this.couponUse === true && countTotal >= 1000) {\n        this.couponDiscount = 200;\n      }\n\n      return countTotal - countCost - this.couponDiscount;\n    }\n  }),\n  methods: _objectSpread({}, mapActions(['getItemsApi', 'getPromotionsApi']), {\n    addToCart: function addToCart(item) {\n      var _this = this;\n\n      var newCartItem = {};\n      newCartItem.id = item.id;\n      newCartItem.name = item.name;\n      newCartItem.type = item.type;\n      newCartItem.price = item.price;\n      var newQuantity = 1;\n      this.incart.forEach(function (ele) {\n        if (ele.id === item.id) {\n          newQuantity = _parseInt(ele.quantity) + 1;\n\n          var theOldOneIndex = _this.incart.indexOf(ele);\n\n          _this.incart.splice(theOldOneIndex, 1);\n        }\n      });\n      newCartItem.quantity = newQuantity;\n      this.incart.push(newCartItem);\n    },\n    checkDiscount: function checkDiscount(promotions) {\n      var _this2 = this;\n\n      this.discount = [];\n      promotions.forEach(function (element) {\n        var countTotal = 0;\n\n        _this2.incart.forEach(function (e) {\n          if (e.type === element.type) {\n            countTotal += e.price * e.quantity;\n          }\n        });\n\n        var result = countTotal * (1 - element.discount);\n\n        _this2.discount.push({\n          type: element.type,\n          discount: element.discount,\n          price: result\n        });\n      });\n    },\n    tableRowClassname: function tableRowClassname(_ref) {\n      var rowIndex = _ref.rowIndex;\n\n      if (rowIndex % 2 === 1) {\n        return 'success-row';\n      }\n\n      return '';\n    },\n    checkCoupon: function checkCoupon() {\n      var _this3 = this;\n\n      console.log('Check Coupon', this.coupon, this.date);\n      PromotionsService.checkCoupon({\n        sn: this.coupon,\n        date: this.date\n      }).then(function (data) {\n        if (data.data.code === 1) {\n          _this3.couponUse = true;\n        }\n      });\n    }\n  }),\n  watch: {\n    date: function date() {\n      this.getPromotionsApi(this.date);\n    }\n  },\n  filters: {\n    rounding: function rounding(value) {\n      return value.toFixed(2);\n    }\n  }\n};",{"version":3,"sources":["Items.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA,SAAA,UAAA,EAAA,UAAA,QAAA,MAAA;AACA,OAAA,UAAA,MAAA,eAAA;AACA,OAAA,oCAAA;AACA,OAAA,iBAAA,MAAA,qCAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA,EAFA;AAGA,MAAA,IAAA,EAAA,YAHA;AAIA,MAAA,MAAA,EAAA,EAJA;AAKA,MAAA,SAAA,EAAA,KALA;AAMA,MAAA,cAAA,EAAA;AANA,KAAA;AAQA,GAXA;AAYA,EAAA,UAAA,EAAA;AACA,IAAA,UAAA,EAAA;AADA,GAZA;AAeA,EAAA,OAfA,qBAeA;AACA,SAAA,WAAA;AACA,SAAA,gBAAA,CAAA,KAAA,IAAA;AACA,GAlBA;AAmBA,EAAA,QAAA,oBACA,UAAA,CAAA;AACA,IAAA,KAAA,EAAA,UADA;AAEA,IAAA,UAAA,EAAA;AAFA,GAAA,CADA;AAKA,IAAA,aAAA,EAAA,yBAAA;AACA,UAAA,aAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,aAAA,IAAA,UAAA,GAAA,CAAA,QAAA,CAAA;AACA,OAFA;AAGA,aAAA,aAAA;AACA,KAXA;AAYA,IAAA,UAAA,EAAA,sBAAA;AACA,UAAA,UAAA,GAAA,IAAA;AACA,UAAA,SAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,UAAA,IAAA,YAAA,GAAA,CAAA,QAAA,GAAA,GAAA,CAAA,KAAA,CAAA;AACA,OAFA;AAGA,WAAA,QAAA,CAAA,OAAA,CAAA,UAAA,OAAA,EAAA;AACA,QAAA,SAAA,IAAA,OAAA,CAAA,KAAA;AACA,OAFA;;AAGA,UAAA,KAAA,SAAA,KAAA,IAAA,IAAA,UAAA,IAAA,IAAA,EAAA;AACA,aAAA,cAAA,GAAA,GAAA;AACA;;AACA,aAAA,UAAA,GAAA,SAAA,GAAA,KAAA,cAAA;AACA;AAzBA,IAnBA;AA8CA,EAAA,OAAA,oBACA,UAAA,CAAA,CACA,aADA,EAEA,kBAFA,CAAA,CADA;AAKA,IAAA,SAAA,EAAA,mBAAA,IAAA,EAAA;AAAA;;AACA,UAAA,WAAA,GAAA,EAAA;AACA,MAAA,WAAA,CAAA,EAAA,GAAA,IAAA,CAAA,EAAA;AACA,MAAA,WAAA,CAAA,IAAA,GAAA,IAAA,CAAA,IAAA;AACA,MAAA,WAAA,CAAA,IAAA,GAAA,IAAA,CAAA,IAAA;AACA,MAAA,WAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,UAAA,WAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,EAAA,KAAA,IAAA,CAAA,EAAA,EAAA;AACA,UAAA,WAAA,GAAA,UAAA,GAAA,CAAA,QAAA,IAAA,CAAA;;AACA,cAAA,cAAA,GAAA,KAAA,CAAA,MAAA,CAAA,OAAA,CAAA,GAAA,CAAA;;AACA,UAAA,KAAA,CAAA,MAAA,CAAA,MAAA,CAAA,cAAA,EAAA,CAAA;AACA;AACA,OANA;AAOA,MAAA,WAAA,CAAA,QAAA,GAAA,WAAA;AACA,WAAA,MAAA,CAAA,IAAA,CAAA,WAAA;AACA,KArBA;AAsBA,IAAA,aAAA,EAAA,uBAAA,UAAA,EAAA;AAAA;;AACA,WAAA,QAAA,GAAA,EAAA;AACA,MAAA,UAAA,CAAA,OAAA,CAAA,UAAA,OAAA,EAAA;AACA,YAAA,UAAA,GAAA,CAAA;;AACA,QAAA,MAAA,CAAA,MAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,CAAA,CAAA,IAAA,KAAA,OAAA,CAAA,IAAA,EAAA;AACA,YAAA,UAAA,IAAA,CAAA,CAAA,KAAA,GAAA,CAAA,CAAA,QAAA;AACA;AACA,SAJA;;AAKA,YAAA,MAAA,GAAA,UAAA,IAAA,IAAA,OAAA,CAAA,QAAA,CAAA;;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,IAAA,CAAA;AACA,UAAA,IAAA,EAAA,OAAA,CAAA,IADA;AAEA,UAAA,QAAA,EAAA,OAAA,CAAA,QAFA;AAGA,UAAA,KAAA,EAAA;AAHA,SAAA;AAKA,OAbA;AAcA,KAtCA;AAuCA,IAAA,iBAvCA,mCAuCA;AAAA,UAAA,QAAA,QAAA,QAAA;;AACA,UAAA,QAAA,GAAA,CAAA,KAAA,CAAA,EAAA;AACA,eAAA,aAAA;AACA;;AACA,aAAA,EAAA;AACA,KA5CA;AA6CA,IAAA,WA7CA,yBA6CA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,cAAA,EAAA,KAAA,MAAA,EAAA,KAAA,IAAA;AACA,MAAA,iBAAA,CAAA,WAAA,CAAA;AACA,QAAA,EAAA,EAAA,KAAA,MADA;AAEA,QAAA,IAAA,EAAA,KAAA;AAFA,OAAA,EAGA,IAHA,CAGA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,IAAA,CAAA,IAAA,KAAA,CAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,IAAA;AACA;AACA,OAPA;AAQA;AAvDA,IA9CA;AAuGA,EAAA,KAAA,EAAA;AACA,IAAA,IADA,kBACA;AACA,WAAA,gBAAA,CAAA,KAAA,IAAA;AACA;AAHA,GAvGA;AA4GA,EAAA,OAAA,EAAA;AACA,IAAA,QADA,oBACA,KADA,EACA;AACA,aAAA,KAAA,CAAA,OAAA,CAAA,CAAA,CAAA;AACA;AAHA;AA5GA,CAAA","sourcesContent":["<template lang=\"pug\">\n  .items\n    | 預設時間\n    el-row\n      el-col(:span='6' :offset='9')\n        datepicker(v-model='date')\n    el-row\n      el-col(:span='16' :offset='4')\n        ul(v-for='(ele, index) in  promotions')\n          li.activity  {{ele.type}}類促銷 ({{ele.discount*10}}折優惠) 時間{{ele.startDate | moment('dddd, MMM Do YYYY')}}~{{ele.endDate | moment('dddd, MMM Do YYYY')}}\n    el-row(:gutter='20')\n      el-col(:span='8' :offset='4')\n        el-table(:data=\"items\" :row-class-name='tableRowClassname')\n          el-table-column(prop='type' label='種類')\n          el-table-column(prop='name' label='名稱')\n          el-table-column(prop='price' label='價錢')\n          el-table-column(label='加入購物車')\n            template(slot-scope='scope')\n              i.el-icon-plus(@click='addToCart(scope.row); checkDiscount(promotions);')\n      el-col(:span='6' :offset='3')\n        el-table(:data='incart')\n          el-table-column(prop='name' label='名稱')\n          el-table-column(prop='quantity' label='數量')\n          el-table-column(label='小計')\n            template(slot-scope='scope')\n              | {{scope.row.price * scope.row.quantity | rounding}}\n        div(v-for='element in discount')\n          p(v-show='element.price>0') {{element.discount*10}}折 {{element.type}}類折扣 共折抵 {{element.price | rounding}}元\n        p.activity(v-show='couponUse') 使用折價卷 (滿1000折200)\n        div 總計: {{countQuantity}}件   總價: {{countTotal | rounding}} 元\n        el-col\n          el-col(:span='20' :offset='1')\n            form\n              el-input(v-model='coupon' placeholder='輸入折價卷')\n              el-button(type='success' icon='el-icon-check' circle @click='checkCoupon()')\n</template>\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport datepicker from 'vue-date-pick'\nimport 'vue-date-pick/dist/vueDatePick.css'\nimport PromotionsService from '../../services/PromotionsService.js'\nexport default {\n  name: 'items',\n  data() {\n    return{\n      incart: [],\n      discount: [],\n      date: '2018-11-11',\n      coupon: '',\n      couponUse: false,\n      couponDiscount: 0\n    }\n  },\n  components: {\n    datepicker\n  },\n  created () {\n    this.getItemsApi()\n    this.getPromotionsApi(this.date)\n  },\n  computed: {\n    ...mapGetters({\n      items: 'getItems',\n      promotions: 'getPromotions'\n    }),\n    countQuantity: function() {\n      var countQuantity = 0\n      this.incart.forEach(ele => {\n        countQuantity += parseInt(ele.quantity)\n      })\n      return countQuantity\n    },\n    countTotal: function () {\n      var countTotal = 0.00\n      var countCost = 0\n      this.incart.forEach(ele => {\n        countTotal += parseFloat(ele.quantity*ele.price)\n      })\n      this.discount.forEach(element => {\n        countCost += element.price\n      })\n      if(this.couponUse === true && countTotal >= 1000) {\n        this.couponDiscount = 200\n      }\n      return countTotal - countCost - this.couponDiscount\n    }\n  },\n  methods: {\n    ...mapActions([\n      'getItemsApi',\n      'getPromotionsApi'\n    ]),\n    addToCart: function(item) {\n      var newCartItem = {};\n      newCartItem.id = item.id\n      newCartItem.name = item.name\n      newCartItem.type = item.type\n      newCartItem.price = item.price\n      var newQuantity = 1\n      this.incart.forEach(ele => {\n        if(ele.id === item.id){\n          newQuantity = parseInt(ele.quantity) +1\n          var theOldOneIndex = this.incart.indexOf(ele)\n          this.incart.splice(theOldOneIndex, 1)\n        }\n      })\n      newCartItem.quantity = newQuantity\n      this.incart.push(newCartItem)\n    },\n    checkDiscount: function(promotions) {\n      this.discount = []\n      promotions.forEach(element => {\n        var countTotal = 0\n        this.incart.forEach(e => {\n          if(e.type === element.type){\n            countTotal += e.price * e.quantity\n          }\n        });\n        var result = countTotal * (1-element.discount)\n        this.discount.push({\n          type: element.type,\n          discount: element.discount,\n          price: result\n        })\n      });\n    },\n    tableRowClassname({rowIndex}) {\n      if (rowIndex%2 === 1) {\n        return 'success-row'\n      } \n      return ''\n    },\n    checkCoupon () {\n      console.log('Check Coupon',this.coupon, this.date)\n      PromotionsService.checkCoupon({\n        sn: this.coupon,\n        date: this.date\n      }).then((data) => {\n        if (data.data.code === 1) {\n          this.couponUse = true\n        }\n      })\n    }\n  },\n  watch: {\n    date () {\n      this.getPromotionsApi(this.date)\n    }\n  },\n  filters: {\n    rounding (value) {\n      return value.toFixed(2)\n    }\n  }\n}\n</script>\n<style>\n  .el-table .success-row {\n    background-color: #f0f9eb;\n  }\n  .activity{\n    color: red;\n  }\n</style>\n"],"sourceRoot":"src/views"}]}